

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/logo.jpg">
  <link rel="icon" href="/img/logo.jpg">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  
  <meta name="theme-color" content="#6aa84f">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="">
  
    <meta name="description" content="Qt 资源系统 资源汇总文件(.qrc) 外部二进制资源 内建资源   压缩 在应用程序中使用资源 使用库中的资源       # Qt 资源系统  Qt 资源系统是一套平台独立的机制，用于将二进制文件存储至应用程序的可执行文件中。这在您的应用始终依赖一组特定文件（如图标、翻译文件等），并且不想承担丢失这些文件的风险时，会非常有用。 资源系统基于 qmake、rcc (Qt 的资源编译器">
<meta property="og:type" content="article">
<meta property="og:title" content="Qt 资源系统">
<meta property="og:url" content="https://txt1994.github.io/2022/03/02/QtDocumentCN/Src/R/The_Qt_Resource_System/The_Qt_Resource_System/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Qt 资源系统 资源汇总文件(.qrc) 外部二进制资源 内建资源   压缩 在应用程序中使用资源 使用库中的资源       # Qt 资源系统  Qt 资源系统是一套平台独立的机制，用于将二进制文件存储至应用程序的可执行文件中。这在您的应用始终依赖一组特定文件（如图标、翻译文件等），并且不想承担丢失这些文件的风险时，会非常有用。 资源系统基于 qmake、rcc (Qt 的资源编译器">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://txt1994.github.io/The_Qt_Resource_System.drawio.svg">
<meta property="article:published_time" content="2022-03-02T06:47:47.000Z">
<meta property="article:modified_time" content="2022-03-18T16:51:57.865Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="资源系统">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://txt1994.github.io/The_Qt_Resource_System.drawio.svg">
  
  
  <title>Qt 资源系统 - Hexo</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4/github-markdown.min.css" />
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hint.css@2/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10/styles/github-gist.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.css" />
  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->

  
<link rel="stylesheet" href="/css/style.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"txt1994.github.io","root":"/","version":"1.8.14","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 6.1.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>txt1994s</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                首页
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                归档
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                标签
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                关于
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                友联
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              &nbsp;<i class="iconfont icon-search"></i>&nbsp;
            </a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="Qt 资源系统">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2022-03-02 14:47" pubdate>
        2022年3月2日 下午
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      4.5k 字
    </span>
  

  
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      38 分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Qt 资源系统</h1>
            
              <p class="note note-info">
                
                  本文最后更新于：2022年3月19日 凌晨
                
              </p>
            
            <div class="markdown-body">
              <div class="toc">

<!-- toc -->

<ul>
<li><a href="#qt-zi-yuan-xi-tong">Qt 资源系统</a><ul>
<li><a href="#zi-yuan-hui-zong-wen-jian-qrc">资源汇总文件(<code>.qrc</code>)</a><ul>
<li><a href="#wai-bu-er-jin-zhi-zi-yuan">外部二进制资源</a></li>
<li><a href="#nei-jian-zi-yuan">内建资源</a></li>
</ul>
</li>
<li><a href="#ya-suo">压缩</a></li>
<li><a href="#zai-ying-yong-cheng-xu-zhong-shi-yong-zi-yuan">在应用程序中使用资源</a></li>
<li><a href="#shi-yong-ku-zhong-de-zi-yuan">使用库中的资源</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

</div>
# Qt 资源系统

<p>Qt 资源系统是一套平台独立的机制，用于将二进制文件存储至应用程序的可执行文件中。这在您的应用始终依赖一组特定文件（如图标、翻译文件等），并且不想承担丢失这些文件的风险时，会非常有用。</p>
<p>资源系统基于 <a href="../../M/QMake_Manual/QMake_Manual.md">qmake</a>、<a href="../../R/Resource_Compiler_rcc/Resource_Compiler_rcc.md">rcc</a> (Qt 的资源编译器) 和 <a href="../../F/QFile/QFile.md">QFile</a> 的密切协作。</p>
<h2><span id="zi-yuan-hui-zong-wen-jian-qrc">资源汇总文件(<code>.qrc</code>)</span><a href="#zi-yuan-hui-zong-wen-jian-qrc" class="header-anchor">#</a></h2><p>通过 <code>.qrc</code> 文件来指定应用程序所关联的资源，该文件基于 XML 格式，包含了磁盘中的文件列表，并为它们标注可选的别名，以供应用程序来获取资源内容。</p>
<p>下文为一个 <code>.qrc</code> 文件范例：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">RCC</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">RCC</span> <span class="hljs-attr">version</span>=<span class="hljs-string">"1.0"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">qresource</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>images/copy.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>images/cut.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>images/new.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>images/open.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>images/paste.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>images/save.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">qresource</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">RCC</span>&gt;</span></code></pre></div>

<p><code>.qrc</code> 文件中列举的资源文件是应用程序资源树的一部分，其中指定的路径为 <code>.qrc</code> 文件所在目录的相对路径。注意，列举的资源文件必须位于 <code>.qrc</code> 文件所在目录或其子目录。</p>
<p>资源数据可以被编译进二进制程序，从而在运行时可被立即获取；也可以生成为二进制文件，随后在应用程序代码中注册至资源系统。</p>
<p>默认情况下，资源文件在应用程序中，可使用它们在资源树中的路径，附加上 <code>:/</code> 前缀来访问，也可以通过名为 <code>qrc</code> 的 <a href="../../U/QUrl/QUrl.md">URL</a> Scheme 来访问。</p>
<p>例如，文件路径 <code>:/images/cut.png</code>，或 链接地址 <code>qrc:///images/cut.png</code>，可以用于访问 <code>cut.png</code> 文件，该文件在应用程序资源树中的路径为 <code>images/cut.png</code>。该路径也可以通过 <code>file</code> 标签的 <code>alias</code> 属性进行修改：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">file</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"cut-img.png"</span>&gt;</span>images/cut.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span></code></pre></div>

<p>此时，该文件可通过 <code>:/cut-img.png</code> 路径访问。也可以通过 <code>qresource</code> 标签的 <code>prefix</code> 属性为 <code>.qrc</code> 文件中的所有资源文件设置路径前缀：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">qresource</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">"/myresources"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"cut-img.png"</span>&gt;</span>images/cut.png<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">qresource</span>&gt;</span></code></pre></div>

<p>在此场景下，该文件可通过 <code>:/myresources/cut-img.png</code> 路径访问。</p>
<p>某些资源需要随用户的区域设置发生改变，如翻译文件或图标。这可以通过在 <code>qresource</code> 标签中添加 <code>lang</code> 属性，为其指定对应的区域名称字符串来实现，例如：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">qresource</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span>&gt;</span>cut.jpg<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">qresource</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">qresource</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"fr"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span> <span class="hljs-attr">alias</span>=<span class="hljs-string">"cut.jpg"</span>&gt;</span>cut_fr.jpg<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">qresource</span>&gt;</span></code></pre></div>

<p>若用户区域为法国（即 <a href="../../L/QLocale/QLocale.md#static-qlocale-qlocalesystem">QLocale::system</a>().name() 函数返回 <code>"fr_FR"</code>），则 <code>:/cut.jpg</code> 会引用至 <code>cut_fr.jpg</code>，其它情况下使用 <code>cut.jpg</code>。</p>
<p><strong>另请参阅</strong>：<a href="../../L/QLocale/QLocale.md">QLocale</a> 文档以获取区域字符串格式的说明。</p>
<p><strong>另请参阅</strong>：<a href="../../F/QFileSelector/QFileSelector.md">QFileSelector</a> 文档以了解另一个基于区域选取资源的机制，该机制可基于操作系统等更多附加信息来进行选取。</p>
<h3><span id="wai-bu-er-jin-zhi-zi-yuan">外部二进制资源</span><a href="#wai-bu-er-jin-zhi-zi-yuan" class="header-anchor">#</a></h3><p>若要生成外部二进制资源，您需要传递 <code>-binary</code> 选项至 <a href="../../R/Resource_Compiler_rcc/Resource_Compiler_rcc.md">rcc</a> 来创建资源数据文件（通常使用 <code>.rcc</code> 扩展名）。二进制资源文件创建完毕后，可以通过 <a href="../../R/QResource/QResource.md">QResource</a> 接口进行注册。</p>
<p>例如，<code>.qrc</code> 文件中指定的一组资源数据，可以通过如下方式进行编译：</p>
<div class="code-wrapper"><pre><code class="hljs bash">rcc -binary myresource.qrc -o myresource.rcc</code></pre></div>

<p>在应用程序中，通过如下代码注册资源：</p>
<div class="code-wrapper"><pre><code class="hljs c++">QResource::<span class="hljs-built_in">registerResource</span>(<span class="hljs-string">"/path/to/myresource.rcc"</span>);</code></pre></div>



<h3><span id="nei-jian-zi-yuan">内建资源</span><a href="#nei-jian-zi-yuan" class="header-anchor">#</a></h3><p>若要将资源编译至二进制程序内，您需要在应用程序的 <code>.pro</code> 文件中指定 <code>.qrc</code> 文件，从而让 <code>qmake</code> 可以感知到它。例如：</p>
<div class="code-wrapper"><pre><code class="hljs ini"><span class="hljs-attr">RESOURCES</span>     = application.qrc</code></pre></div>

<p><code>qmake</code> 会生成编译规则来创建名为 <code>qrc_application.cpp</code> 的源文件，并将其链接至应用程序。该文件包含以 C++ 静态数组的形式存储的图片和其它所有资源的二进制压缩数据。<code>qrc_application.cpp</code> 文件会在 <code>.qrc</code> 文件或其引用的任意资源文件发生改变时自动重新生成。若您不使用 <code>.pro</code> 文件，则需要手动执行 <code>rcc</code>，或将其添加到您的构建系统中。</p>
<p><img src="/The_Qt_Resource_System.drawio.svg" srcset="/img/loading.gif" lazyload alt="资源编译至应用程序内"></p>
<p>目前，Qt 总是将数据直接存储至可执行程序内，无论是 Windows、macOS 还是 iOS——这些操作系统都提供了内嵌资源的原生支持。这个模式在 Qt 未来的版本中可能会有改变。</p>
<h2><span id="ya-suo">压缩</span><a href="#ya-suo" class="header-anchor">#</a></h2><p><code>rcc</code> 会尝试压缩资源数据来减少最终生成的二进制文件的磁盘占用。通常情况下，会通过启发式的检查来决定是否值得进行压缩，并且在无法有效压缩的情况下直接存储未压缩的内容。您可以使用 <code>-threshold</code> 来控制判断阈值，该选项告知 <code>rcc</code> 源文件压缩后获得的体积缩减必须不小于该百分比。</p>
<div class="code-wrapper"><pre><code class="hljs c++">rcc -threshold <span class="hljs-number">25</span> myresources.qrc</code></pre></div>

<p>默认值为 <code>70</code>，意味着压缩后的文件必须比源文件小 70%（即不大于源文件的 30% 大小）。</p>
<p>若有需要的话，也可以关闭压缩，这在资源文件中包含已经压缩过的数据时（如 <code>.png</code> 文件）非常有用——否则会在编译时浪费 CPU 时间来确认它的确不能被再次压缩。另一个原因则是无需考虑磁盘占用，并且想让资源在运行时以可直接访问的原始数据存放于内存中，而非需要解压才可使用的压缩数据。您可以通过命令行参数 <code>-no-compress</code> 来实现此目的。</p>
<div class="code-wrapper"><pre><code class="hljs bash">rcc -no-compress myresources.qrc</code></pre></div>

<p><code>rcc</code> 同样给予用户控制压缩算法和压缩等级的权限，例如：</p>
<div class="code-wrapper"><pre><code class="hljs bash">rcc -compress 2 -compress-algo zlib myresources.qrc</code></pre></div>

<p>另外，也可以在 <code>.qrc</code> 文件中 <code>file</code> 标签的 <code>threshold</code>、<code>compress</code> 和 <code>compress-algo</code> 属性来进行设置：</p>
<div class="code-wrapper"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">qresource</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">file</span> <span class="hljs-attr">compress</span>=<span class="hljs-string">"1"</span> <span class="hljs-attr">compress-algo</span>=<span class="hljs-string">"zstd"</span>&gt;</span>data.txt<span class="hljs-tag">&lt;/<span class="hljs-name">file</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">qresource</span>&gt;</span></code></pre></div>

<p>上述代码选择 <code>zstd</code> 算法，使用压缩等级 1.</p>
<p><code>rcc</code> 支持如下压缩算法和压缩等级：</p>
<ul>
<li><code>best</code>：使用下述算法中的最优者，并使用其最高压缩等级，以编译时的 CPU 时间为代价来获得最高压缩率。此参数在 XML 文件中可用于指明无论 <code>rcc</code> 支持何种压缩算法，该文件都应被尽可能地压缩。</li>
<li><code>zstd</code>：使用 <a target="_blank" rel="noopener" href="https://zstd.net/">Zstandard</a> 库进行压缩。有效压缩等级为 1 至 19，1 为最低压缩率（最短 CPU 时间），19 为最高压缩率（最长 CPU 时间）。默认等级为 14。特殊值 0 用于告知 <code>zstd</code> 库自由选择其默认的压缩率。</li>
<li><code>zlib</code>：使用 <a target="_blank" rel="noopener" href="https://zlib.net/">zlib</a> 库进行压缩。有效压缩等级为 1 至 9，1 为最低压缩率（最短 CPU 时间），9 为最高压缩率（最长 CPU 时间）。特殊值 0 代表“无需压缩”，并且不应被使用。默认值为实现定义，通常为 6。</li>
<li><code>none</code>：无压缩。该参数等价于 <code>-no-compress</code> 选项。</li>
</ul>
<p>Zstandard 和 zlib 均为可选支持。若运行时未检测到对应的库，则通过 <code>-compress-algo</code> 指定该库的操作会报错。默认情况下，若 <code>zstd</code> 可用则使用该算法，否则使用 <code>zlib</code>。</p>
<h2><span id="zai-ying-yong-cheng-xu-zhong-shi-yong-zi-yuan">在应用程序中使用资源</span><a href="#zai-ying-yong-cheng-xu-zhong-shi-yong-zi-yuan" class="header-anchor">#</a></h2><p>在应用程序中，资源路径可用于绝大多数常规文件系统路径的中。例如，可以传递资源路径而非文件路径至 <a href="../../I/QIcon/QIcon.md">QIcon</a>，<a href="../../I/QImage/QImage.md">QImage</a> 或 <a href="../../P/QPixmap/QPixmap.md">QPixmap</a> 的构造函数：</p>
<div class="code-wrapper"><pre><code class="hljs c++">cutAct = <span class="hljs-keyword">new</span> <span class="hljs-built_in">QAction</span>(<span class="hljs-built_in">QIcon</span>(<span class="hljs-string">":/images/cut.png"</span>), <span class="hljs-built_in">tr</span>(<span class="hljs-string">"Cu&amp;t"</span>), <span class="hljs-keyword">this</span>);</code></pre></div>

<p><strong>另请参阅</strong>：<a href="../../A/Application_Example/Application_Example.md">Application</a> 范例以了解实际程序中如何使用 Qt 的资源系统来存储图标。</p>
<p>资源在内存中以资源对象树形式表达，该对象树在程序启动时构建，通过 <a href="../../F/QFile/QFile.md">QFile</a> 来将其路径解析至资源数据。可通过 <code>":/"</code> 初始化 <a href="../../D/QDir/QDir.md">QDir</a> 对象，来从根部遍历该对象树。</p>
<p>Qt 的资源系统支持搜索路径列表概念。若通过 <code>:</code> 而非 <code>:/</code> 前缀来指定资源，则会通过搜索路径列表来检索该资源。搜索路径列表在程序启动时为空，可通过 <a href="../../D/QDir/QDir.md#static-void-qdiraddsearchpathconst-qstring-prefix-const-qstring-path">QDir::addSearchPath</a>() 来添加路径。</p>
<h2><span id="shi-yong-ku-zhong-de-zi-yuan">使用库中的资源</span><a href="#shi-yong-ku-zhong-de-zi-yuan" class="header-anchor">#</a></h2><p>若在库中包含资源，则需要调用 <a href="../../D/QDir/QDir.md#void-qinitresourcename">Q_INIT_RESOURCE</a>() 来强制初始化资源，调用参数为 <code>.qrc</code> 文件的基本名称，例如</p>
<div class="code-wrapper"><pre><code class="hljs c++">MyClass::<span class="hljs-built_in">MyClass</span>() : <span class="hljs-built_in">BaseClass</span>()
{
    <span class="hljs-built_in">Q_INIT_RESOURCE</span>(resources);

    <span class="hljs-function">QFile <span class="hljs-title">file</span><span class="hljs-params">(<span class="hljs-string">":/myfile.dat"</span>)</span></span>;
    ...
}</code></pre></div>

<p>这确保了在静态链接时，资源数据可被链接至最终的应用程序。该初始化代码应该紧贴在库中使用资源的位置之前，以确保仅当该库的使用者使用到依赖资源的特性时，才会将资源链接至程序。</p>
<p>注意：由于 <code>rcc</code> 生成的资源初始化器定义在全局命名空间，<a href="../../D/QDir/QDir.md#void-qinitresourcename">Q_INIT_RESOURCE</a>() 的调用也必须位于任何命名空间之外。</p>
<p>若该库包含的资源不在内部使用，而是暴露给库的使用者，则初始化操作需要发生在应用程序代码中，例如：</p>
<div class="code-wrapper"><pre><code class="hljs c++"><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">int</span> argc, <span class="hljs-type">char</span> *argv[])</span></span>
<span class="hljs-function"></span>{
    <span class="hljs-function">QApplication <span class="hljs-title">app</span><span class="hljs-params">(argc, argv)</span></span>;
    <span class="hljs-built_in">Q_INIT_RESOURCE</span>(graphlib);

    <span class="hljs-function">QFile <span class="hljs-title">file</span><span class="hljs-params">(<span class="hljs-string">":/graph.png"</span>)</span></span>;
    ...
    <span class="hljs-keyword">return</span> app.<span class="hljs-built_in">exec</span>();
}</code></pre></div>

<p>如上文所述，此方式确保了资源数据可在静态链接时被链接至最终的应用程序，同时也会在动态链接时触发库的加载动作，如加载插件。</p>
<p>类似地，若想显示地卸载一组资源（因为需要卸载插件，或该资源不再被使用），则可通过调用 <a href="../../D/QDir/QDir.md#void-qcleanupresourcename">Q_CLEANUP_RESOURCE</a>() 来强制移除资源，调用参数与上文相同。</p>
<p><strong>注意</strong>：若资源文件被编译为应用程序的一部分，则不需要使用 <a href="../../D/QDir/QDir.md#void-qinitresourcename">Q_INIT_RESOURCE</a>() 和 <a href="../../D/QDir/QDir.md#void-qcleanupresourcename">Q_CLEANUP_RESOURCE</a>()。</p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E8%B5%84%E6%BA%90%E7%B3%BB%E7%BB%9F/">资源系统</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">
                  
                    本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！
                  
                </p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2022/03/02/QtDocumentCN/Src/R/QRegularExpressionValidator/QRegularExpressionValidator/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">QRegularExpressionValidator类</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2022/03/02/QtDocumentCN/Src/R/Resource_Compiler_rcc/Resource_Compiler_rcc/">
                        <span class="hidden-mobile">资源编译器</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments" lazyload>
                
                  
                
                
  <div id="lv-container" data-id="city" data-uid="MTAyMC81NTMzMi8zMTc5OQ==">
    <script type="text/javascript">
      Fluid.utils.loadComments('#lv-container', function() {
        Fluid.utils.createScript('https://cdn-city.livere.com/js/embed.dist.js');
      });
    </script>
    <noscript>Please enable JavaScript to view the comments</noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>


  <!-- SCRIPTS -->
  
  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->


  <script  src="/js/local-search.js" ></script>



  
    <script  src="/js/img-lazyload.js" ></script>
  



  



  
    <script  src="https://cdn.jsdelivr.net/npm/tocbot@4/dist/tocbot.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3/dist/jquery.fancybox.min.js" ></script>
  
  
    <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4/anchor.min.js" ></script>
  
  
    <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js" ></script>
  






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
        typing(title);
      
    })(window, document);
  </script>















<!-- 主题的启动项 保持在最底部 -->
<script  src="/js/boot.js" ></script>


</body>
</html>
